<div id="#questionnaire-hero" class="card card--no-line">
  <h1><%= @questionnaire.title %></h1>
  <p><%= @questionnaire.description %></p>
</div>

<%= render 'questionnaires/subnavbar' %>

<div id="questionnaire-main-view" class="card">
  <%= form_with(model: @submission, url: questionnaire_submission_path(@questionnaire, @submission), method: :put) do |f| %>
      <%= f.fields_for :submission_values, @submission.whole_submission_values do |submission_values_f| %>
        <fieldset class="field field--stacked">
          <% question = submission_values_f.object.question %>
          <%= submission_values_f.hidden_field :id, value: submission_values_f.object.id %>
          <%= submission_values_f.hidden_field :question_id, value: question.id %>
          <%= submission_values_f.label :value do %>
            <%= question.name %> <span class="mini-label"><%= question.value_type %></span>
            <% unless question.is_emptyable? %>
              <span class="mini-label">required</span>
            <% end %>
            <% if submission_values_f.object.errors.any? %>
              <em>(<%= submission_values_f.object.errors[:value].join("; ") %>)</em>
            <% end %>
          <% end %>
          <%= submission_values_f.text_field :value, pattern: question.valid_pattern %>
        </fieldset>
    <% end %>

    <div class="actions">
      <%= f.submit "update submission", class: "button" %>
      <%= link_to "back", questionnaire_path(@questionnaire), class: "button" %>
    </div>
  <% end %>
</div>
